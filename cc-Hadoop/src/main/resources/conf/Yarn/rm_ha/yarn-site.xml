<?xml version="1.0"?>

<!--### 5、yarn资源调度：yarn-site.xml（分发到其它机器） ###-->
<!--### Yarn HA RM高可用 ###-->

<configuration>

    <!--将MR任务的执行交给yarn资源调度来管理-->
    <property>
        <name>yarn.nodemanager.aux-services</name>
        <value>mapreduce_shuffle</value>
    </property>

    <!--开启RM高可用-->
    <property>
        <name>yarn.resourcemanager.ha.enabled</name>
        <value>true</value>
    </property>

    <!--RM集群名称，确保RM参与该集群的leader选举，而不影响其他集群-->
    <property>
        <name>yarn.resourcemanager.cluster-id</name>
        <value>rm_cluster</value>
    </property>

    <!--声明RM集群的节点：两个RM高可用-->
    <property>
        <name>yarn.resourcemanager.ha.rm-ids</name>
        <value>rm1,rm2</value>
    </property>

    <!--指定RM1节点的地址-->
    <property>
        <name>yarn.resourcemanager.hostname.rm1</name>
        <value>bd91</value>
    </property>

    <!--指定RM2节点的地址-->
    <property>
        <name>yarn.resourcemanager.hostname.rm2</name>
        <value>bd92</value>
    </property>

    <!--RM1的Web页面访问地址-->
    <property>
        <name>yarn.resourcemanager.webapp.address.rm1</name>
        <value>bd91:8088</value>
    </property>

    <!--RM2的Web页面访问地址-->
    <property>
        <name>yarn.resourcemanager.webapp.address.rm2</name>
        <value>bd92:8088</value>
    </property>

    <!--开启RM宕机自动重启恢复，默认false-->
    <property>
        <name>yarn.resourcemanager.recovery.enabled</name>
        <value>true</value>
    </property>

    <!--配置RM状态信息持久存储方式：有FileSystemRMStateStore和ZKRMStateStore-->
    <!--ZKRMStateStore：存储是隐式隔离的，这意味着单个RM可以在任何时间点使用存储-->
    <property>
        <name>yarn.resourcemanager.store.class</name>
        <value>org.apache.hadoop.yarn.server.resourcemanager.recovery.ZKRMStateStore</value>
    </property>

    <!--配置为Zookeeper持久存储时，指定Zookeeper集群的地址 -->
    <property>
        <name>yarn.resourcemanager.zk-address</name>
        <value>bd91:2181,bd92:2181,bd93:2181</value>
    </property>

    <!--是否将对容器实施物理内存限制-->
    <property>
        <name>yarn.nodemanager.pmem-check-enabled</name>
        <value>false</value>
    </property>

    <!--是否将对容器实施虚拟内存限制-->
    <property>
        <name>yarn.nodemanager.vmem-check-enabled</name>
        <value>false</value>
    </property>

    <!--开启日志聚集-->
    <property>
        <name>yarn.log-aggregation-enable</name>
        <value>true</value>
    </property>

    <!--设置Yarn历史服务器地址-->
    <property>
        <name>yarn.log.server.url</name>
        <value>hdfs://bd91:19888/jobhistory/logs</value>
    </property>

    <!--设置Yarn历史日志保存时间7天-->
    <property>
        <name>yarn.log-aggregation.retain-seconds</name>
        <value>604880</value>
    </property>

</configuration>
